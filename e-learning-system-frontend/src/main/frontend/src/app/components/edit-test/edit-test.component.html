<div class="wrapper">
  <div class="content">

    <form class="container pt-2" [formGroup]="testForm" (ngSubmit)="onSubmit()">
      <h1>{{testForm.value.testName}}</h1>
      <div formArrayName="questions">
        <div [formGroupName]="i" *ngFor="let question of testForm.get('questions').controls; index as i">
          <div class="form-group">
            <input class="form-control" formControlName="question" placeholder="Enter question"
                   [class.is-invalid]="question.invalid">
            <small class="text-danger" *ngIf="question.invalid">Required</small>
            <div formArrayName="answers">
              <div [formGroupName]="a" *ngFor="let answer of question.get('answers').controls; index as a">
                <div class="form-group">
                  <input
                    class="form-control"
                    formControlName="answer"
                    placeholder="Enter answer"
                    [class.is-invalid]="answer.invalid">
                  <div *ngIf="answer.invalid" class="invalid-feedback">
                    <div *ngIf="answer.controls.answer.errors.unique">
                      not unique
                    </div>
                  </div>
                  <div *ngIf="!question.invalid">
                    <label>
                      <input type="radio" formControlName="correctAnswer" [value]="true"
                             (change)="onSelect(question,answer)"
                             title="correctAnswer">
                      <span>right</span>
                    </label>
                  </div>
                </div>
              </div>
              <div></div>
              <button type="button" class="btn btn-primary" (click)="addAnswer(i)">Add answer</button>
            </div>
          </div>
        </div>
        <button type="button" class="btn btn-primary" (click)="addQuestion()">Add question</button>
      </div>
      <div class="submit-form">
        <button [disabled]="loading"
                type="submit"
                class="btn btn-primary">
          Save
        </button>
        <img *ngIf="loading" src="../../../assets/img/loading.gif">
        <button class="btn btn-secondary" routerLink="../">Cancel</button>
      </div>
    </form>

    <pre>
  {{ testForm.value | json }}
</pre>

  </div>
</div>
